name: Dependencies Review Trigger

# --------------------------------------------------------------------------
# Use pull_request_target to ensure the workflow runs with permissions
# from the BASE repository, which is necessary for creating reviews,
# adding labels, and commenting, even on PRs from a fork.
# --------------------------------------------------------------------------
on:
  pull_request_target:
    types: [opened, reopened, synchronize]
    branches:
      - main

jobs:
  call_deps_reviewer:
    name: Call Dependencies Review Workflow
    uses: marcusburghardt/github-standards/.github/workflows/reusable_deps_reviewer.yml@main

  #call_dependabot_reviewer:
  #  name: Call Dependabot Review Workflow
  #  uses: marcusburghardt/github-standards/.github/workflows/reusable_dependabot_reviewer.yml@main

  comment_dependencies_review:
    runs-on: ubuntu-latest
    needs: call_deps_reviewer
    permissions:
      issues: write
    steps:
      - name: Comment from Dependencies Reviewer
        uses: peter-evans/create-or-update-comment@71345be0265236311c031f5c7866368bd1eff043 # v4.0.0
        env:
          REVIEW_CONCLUSION: ${{ needs.call_deps_reviewer.outputs.review_conclusion }}
          REVIEW_SUMMARY: ${{ needs.call_deps_reviewer.outputs.review_summary }}
        with:
          issue-number: ${{ github.event.pull_request.number }}
          body: |
            ðŸ¤– **Standardized Dependencies Review Summary** ðŸ¤–

            - **Dependencies Review Conclusion:** **${{ env.REVIEW_CONCLUSION }}**

            ---

            Dependencies Review Summary
            ${{ env.REVIEW_CONCLUSION }}
